<!DOCTYPE html>
<html>
  <title>Dynamic Asteroids</title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <script src="js/lib/animatic.js"></script>
  <script src="js/spaceship.js"></script>
  <script src="js/asteroid.js"></script>
  <script>
    var canvas; 
    var spaceship; 
    var asteroids = []; 
    var asteroidSprite;

    function update(){
      var context = canvas.getContext('2d');
      context.fillStyle = "rgb(0,0,0)";
      context.fillRect(0, 0, canvas.width, canvas.height);
      context.save();
      spaceship.paint(context);
      context.restore();
      for (var i = 0; i < asteroids.length; i++) {
        context.save();
        asteroids[i].paint(context);
        context.restore();
      }
    }

    function repaintLoop(){
      update();
      setTimeout("repaintLoop()", 30);
    }

    function init(){
      canvas = document.getElementById("asteroids-game");
      asteroidSprite = document.getElementById("asteroid-sprite");
      spaceship = new Spaceship();
      for(var i = 0; i < 10; i++){
        asteroids[i] = new Asteroid();
      }
      repaintLoop();
    }

    function keyDown(event){
      switch (event.keyCode){
        case 37: // LEFT
          spaceship.turnLeft();
          break;
        case 38: // UP
          spaceship.speedUp();
          break;
        case 39: // RIRGHT
          spaceship.turnRight();
          break;
        case 40: // DOWN
          spaceship.slowDown();
          break;
        default:
          // nothing
      }
      return false;
    }

    window.onload = init;
    window.onkeydown = keyDown;
  </script>
  <body>
    <img src="img/asteroid.png" id="asteroid-sprite" style="display: none"/>
    <canvas id="asteroids-game" width="800" height="600">
      Sorry, your browser does not support the canvas element. 
      Upgrade to a modern browser
    <canvas>
  </body>
</html>

